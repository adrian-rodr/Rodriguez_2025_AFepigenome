# Rodriguez_2025_AFepigenome

This archive contains processed files and scripts associated with **Rodriguez et al (2025)**, *"An epigenomic investigation of atrial fibrillation in a matched left and right atrial human cohort"*. doi: https://doi.org/10.1101/2025.08.29.673028

The repository includes data derived from genome-wide sequencing and microarray analysis, as well as code used for downstream analyses and for generating the figures presented in the publication.

The raw ChIP-sequencing and DNA methylation array data reported in this study have been deposited in the GEO under accession numbers **GSE227793** and **GSE291249**, respectively.

## ChIP-seq data analysis

***Basic processing: alignment and peak calling***

The script [`Read_alignment_AF-ChIP-seq_dataset.pl`] was used to submit alignment jobs. [`BAM_files_preprocessing.pl`]performs basic preprocessing of BAM files prior to peak calling (i.e., removing multi-mapping reads and subsampling to 20M reads). Peak calling was conducted using [`MACS2_peak_calling.sh`], which generate **.bedGraph** and **narrowPeak** files used for downstream analyses. This script also produces fold-enrichment (FE) **.bdg** files, which can be loaded into genome browsers for visualisation of peak regions.

**Note:**
The above scripts are provided as-is for transparency. They were written for execution on the QMUL Apocrita HPC cluster and may not reproduce identically in other computing environments. Users intending to adapt these scripts should update cluster-specific resources (e.g. genome indices, module load path, etc.).

***Definition of regulatory regions across each sample type***

Scripts and files can be found in `Genrich_RegRegions_definition` directory.

[`Genrich_Reg_regions_across_sample_type.R`] produces regulatory regions plots presented in S1d-f. 

## Differential analysis of ChIP-seq data with standard methods

Scripts and files can be found in `ChIP-seq_basic_processing` directory.

The script [`ChIPseq_DiffEnrich_Analysis_DiffBind_TCSeq.R`] was used to identify differentially enriched regions across anatomical sides (RAvsLA) and disease status (AFvsSR) of atrial samples using standard methods (**DiffBind and TCSeq**). It takes as input the **.narrowPeak** generated during peak calling and corresponding sample sheets containing metadata. 

## Definition of enriched H3K27ac regions across sample groups

Scripts and files can be found in `ChIP-H3K27ac_enriched_regions_definition` directory.

[`MACS2_bdgdiff_pairwise_comparisons.sh`] perfoms pairwise comparisons across all individual samples in the dataset to identify peaks showing differential enrichment between sample pairs. This script takes as input files generated by [`MACS2_peak_calling.sh`], located in the `ChIP-seq_basic_processing` directory.

[`Definition_of_enriched_regions_across_groups.R`] takes the resulting BED files from pairwise comparisons, defines sets of H3K27ac-enriched regions across sample groups, and performs downstream analyses. The outputs produces plots presented in Figures 1, 2, 3, S1, S2 and S4, as well as the data reported in Supplementary Tables S2 and S3. 


## RNA-seq analysis of differential gene expression

Scripts and files can be found in `RNAseq_DGE_analysis` directory.

Raw data generated for a previous study (Alison *et al.*, PMID: 31172864) were obtained from **GEO accession GSE128188**.

The script [`Read_alignment_AF-RNA-seq_dataset.pl`] was used to perform read alignment to human hg38 reference genome with STAR. Sequencing reads were mapped to genomic features using featureCounts ([`featureCounts.sh`]), and DESeq2 was employed for differential expression analysis ([`RNAseq_DE_Analysis.R`]). 

## RT-qPCR and ChIP-qPCR

Scripts and files can be found in `QPCR_data_analysis` directory.

The script [`QPCR_data.R`] imports processed files containing normalised data and generates the expression/enrichment qPCR plots presented in Figures 4 and 5 and Supplementary Figure S5.

## DNAm EPICv2 array analysis

Scripts and files can be found in `DNAm_data_analysis` directory.

The script [`DNAm_data_analysis.R`] performs DMR analysis with ***dmrff*** and explores methylation levels in regions of interest. 


## Transcription Factor Enrichment analysis

Scripts and files are located in the `TF_enrichment_analysis` directory.

The script [`HOMER_enrichment_analysis.sh`] performs de novo TF motif enrichment analysis over H3K27ac-enriched regions and DMRs using the [`findMotifsGenome.pl`] function from the HOMER software package (v5.1) (HOMER must be installed prior to running this script).

The script [`TF_enrichment_analysis.R`] processes the output generated by HOMER and creates summary plots for visualisation. It also runs the ReMapEnrich R package to assess the significance of TF binding sites from ChIP-seq experimental data obtained in the ReMap 2024 catalogue. Finally, it generates enrichment plots for AF-associated TFs over DMRs based on motif occurrences scanned by the MEME suite tool FIMO. 